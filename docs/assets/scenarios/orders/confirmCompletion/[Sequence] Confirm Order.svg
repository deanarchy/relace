<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="573px" preserveAspectRatio="none" style="width:884px;height:573px;background:#FFFFFF;" version="1.1" viewBox="0 0 884 573" width="884px" zoomAndPan="magnify"><defs><filter height="300%" id="f1e2q8d2uscpnz" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="561.9999" style="stroke:#A80036;stroke-width:1.0;" width="404" x="377" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="87" x="535.5" y="18.077">Order Domain</text><rect fill="#FFFFFF" filter="url(#f1e2q8d2uscpnz)" height="358.4001" style="stroke:#000000;stroke-width:2.0;" width="860" x="10" y="105.7999"/><rect fill="#FFFFFF" height="163.2" style="stroke:none;stroke-width:1.0;" width="860" x="10" y="301"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="76" x2="76" y1="88.7999" y2="481.2"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="230" x2="230" y1="88.7999" y2="481.2"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="482" x2="482" y1="88.7999" y2="481.2"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="719" x2="719" y1="88.7999" y2="481.2"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="823" x2="823" y1="88.7999" y2="481.2"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="20" y="85.0059">User (Customer)</text><ellipse cx="76" cy="15" fill="#FEFECE" filter="url(#f1e2q8d2uscpnz)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M76,23 L76,50 M63,31 L89,31 M76,50 L63,65 M76,50 L89,65 " fill="none" filter="url(#f1e2q8d2uscpnz)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="20" y="493.2059">User (Customer)</text><ellipse cx="76" cy="506.9999" fill="#FEFECE" filter="url(#f1e2q8d2uscpnz)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M76,514.9999 L76,541.9999 M63,522.9999 L89,522.9999 M76,541.9999 L63,556.9999 M76,541.9999 L89,556.9999 " fill="none" filter="url(#f1e2q8d2uscpnz)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f1e2q8d2uscpnz)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="50" x="203" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="210" y="73.0059">Client</text><rect fill="#FEFECE" filter="url(#f1e2q8d2uscpnz)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="50" x="203" y="480.2"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="210" y="500.2059">Client</text><rect fill="#FEFECE" filter="url(#f1e2q8d2uscpnz)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="198" x="381" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="184" x="388" y="73.0059">ConfirmCompletionController</text><rect fill="#FEFECE" filter="url(#f1e2q8d2uscpnz)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="198" x="381" y="480.2"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="184" x="388" y="500.2059">ConfirmCompletionController</text><rect fill="#FEFECE" filter="url(#f1e2q8d2uscpnz)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="112" x="661" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="668" y="73.0059">OrderDatabase</text><rect fill="#FEFECE" filter="url(#f1e2q8d2uscpnz)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="112" x="661" y="480.2"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="668" y="500.2059">OrderDatabase</text><rect fill="#FEFECE" filter="url(#f1e2q8d2uscpnz)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="65" x="791" y="49"/><rect fill="#FEFECE" filter="url(#f1e2q8d2uscpnz)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="65" x="787" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="794" y="73.0059">Account</text><rect fill="#FEFECE" filter="url(#f1e2q8d2uscpnz)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="65" x="791" y="480.2"/><rect fill="#FEFECE" filter="url(#f1e2q8d2uscpnz)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="65" x="787" y="484.2"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="794" y="504.2059">Account</text><path d="M10,105.7999 L70,105.7999 L70,112.7999 L60,122.7999 L10,122.7999 L10,105.7999 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="358.4001" style="stroke:#000000;stroke-width:2.0;" width="860" x="10" y="105.7999"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15" x="25" y="118.8769">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="74" x="85" y="118.0189">[accept order]</text><polygon fill="#A80036" points="218,141,228,145,218,149,222,145" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="76" x2="224" y1="145" y2="145"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="83" y="139.477">Accept the completion</text><polygon fill="#A80036" points="470,170.6,480,174.6,470,178.6,474,174.6" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="230" x2="476" y1="174.6" y2="174.6"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="237" y="169.077">PUT /api/orders/{order.id}/complete</text><polygon fill="#A80036" points="707,200.2,717,204.2,707,208.2,711,204.2" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="482" x2="713" y1="204.2" y2="204.2"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210" x="489" y="198.677">Write order data (status: Completed)</text><polygon fill="#A80036" points="811.5,229.8,821.5,233.8,811.5,237.8,815.5,233.8" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="482" x2="817.5" y1="233.8" y2="233.8"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="489" y="228.277">&lt;&lt; Event CompletionAccepted &gt;&gt;</text><polygon fill="#A80036" points="811.5,259.4,821.5,263.4,811.5,267.4,815.5,263.4" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="482" x2="817.5" y1="263.4" y2="263.4"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="489" y="257.877">&lt;&lt; Event OrderCompleted &gt;&gt;</text><polygon fill="#A80036" points="241,289,231,293,241,297,237,293" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="235" x2="481" y1="293" y2="293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="247" y="287.477">200 OK Resource Updated</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="870" y1="302" y2="302"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="68" x="15" y="312.2189">[reject order]</text><polygon fill="#A80036" points="218,333.7999,228,337.7999,218,341.7999,222,337.7999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="76" x2="224" y1="337.7999" y2="337.7999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="83" y="332.2769">Reject the completion</text><polygon fill="#A80036" points="470,363.4,480,367.4,470,371.4,474,367.4" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="230" x2="476" y1="367.4" y2="367.4"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228" x="237" y="361.8769">DELETE /api/orders/{order.id}/complete</text><polygon fill="#A80036" points="707,393,717,397,707,401,711,397" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="482" x2="713" y1="397" y2="397"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213" x="489" y="391.477">Write order data (status: OnProcess)</text><polygon fill="#A80036" points="811.5,422.6,821.5,426.6,811.5,430.6,815.5,426.6" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="482" x2="817.5" y1="426.6" y2="426.6"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194" x="489" y="421.077">&lt;&lt; Event CompletionRejected &gt;&gt;</text><polygon fill="#A80036" points="241,452.2,231,456.2,241,460.2,237,456.2" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="235" x2="481" y1="456.2" y2="456.2"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="247" y="450.677">200 OK Resource Updated</text><!--MD5=[180aea16d55cfa7389d2b88861e79948]
@startuml [Sequence] Confirm Order


actor "User (Customer)" as User
participant Client as Client

box "Order Domain"
participant ConfirmCompletionController
participant OrderDatabase
end box

collections Account as Account

alt accept order
    User -> Client: Accept the completion
    Client -> ConfirmCompletionController: PUT /api/orders/{order.id}/complete
    ConfirmCompletionController -> OrderDatabase: Write order data (status: Completed)
    ConfirmCompletionController - - -> Account: << Event CompletionAccepted >>
    ConfirmCompletionController - - -> Account: << Event OrderCompleted >>
    ConfirmCompletionController - -> Client: 200 OK Resource Updated

else reject order
    User -> Client: Reject the completion
    Client -> ConfirmCompletionController: DELETE /api/orders/{order.id}/complete
    ConfirmCompletionController -> OrderDatabase: Write order data (status: OnProcess)
    ConfirmCompletionController - - -> Account: << Event CompletionRejected >>
    ConfirmCompletionController - -> Client: 200 OK Resource Updated
end

@enduml

PlantUML version 1.2021.7(Sun May 23 19:40:07 WIB 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>